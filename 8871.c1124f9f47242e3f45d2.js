(self.webpackChunkidleGame=self.webpackChunkidleGame||[]).push([[8871],{8871:(e,t,r)=>{"use strict";r.r(t),r.d(t,{Tab1PageModule:()=>b});var n=r(7823),a=r(8583),o=r(665),i=r(581),s=r(2316);const l={name:"Imp",description:"",type:"",health:20,maxHealth:20,power:10,defence:5,multiplier:1,rewards:{resources:[{type:"Build",amount:5}],experience:5,money:10}},d={name:"Ogre",description:"",type:"",health:300,maxHealth:300,power:100,defence:50,multiplier:1,rewards:{resources:[{type:"Build",amount:100}],experience:50,money:100}},c=["Amber","Amethyst","Blood","Caulk","Chalk","Cobalt","Copper","Diamond","Emerald","Frosting","Garnet","Gold","Iodine","Jet","Malachite","Marble","Mercury","Obsidian","Opal","Polychromite","Quartz","Rainbow","Redstone","Rock Candy","Rose Quartz","Ruby","Rust","Shale","Star Sapphire","Sulfur","Sunstone","Tar","Titanium","Topaz","Uranium"];var p=r(639),h=r(171);function u(e,t){1&e&&(p.TgZ(0,"div",17),p._uU(1,"Safe"),p.qZA())}function g(e,t){1&e&&(p.TgZ(0,"div",18),p._uU(1,"Dangerous"),p.qZA())}function m(e,t){if(1&e){const e=p.EpF();p.TgZ(0,"li",19),p.TgZ(1,"span",20),p._uU(2),p.qZA(),p.TgZ(3,"div",21),p.TgZ(4,"div",22),p._uU(5),p.qZA(),p.qZA(),p.TgZ(6,"img",23),p.NdJ("click",function(){const t=p.CHM(e).$implicit,r=p.oxw().index;return p.oxw().clickEnemy(t,r)}),p.qZA(),p.qZA()}if(2&e){const e=t.$implicit,r=t.index,n=p.oxw().index,a=p.oxw();p.s9C("id","f"+n.toString()+(e.name+r).toString()),p.xp6(2),p.lnq("",a.setEnemyPos(e,r,n),"",e.type," ",e.name,""),p.xp6(3),p.Oqu(a.enemyHealthBarWidth(e,r,n))}}function f(e,t){if(1&e&&(p.TgZ(0,"div",8),p.TgZ(1,"div",9),p.TgZ(2,"div",10),p._uU(3),p.qZA(),p.YNc(4,u,2,0,"div",11),p.YNc(5,g,2,0,"div",12),p.qZA(),p.TgZ(6,"section",13),p._UZ(7,"ul",14),p.TgZ(8,"ul",15),p.YNc(9,m,7,5,"li",16),p.qZA(),p.qZA(),p.qZA()),2&e){const e=t.$implicit,r=t.index;p.xp6(3),p.hij("Floor ",r+1,""),p.xp6(1),p.Q6J("ngIf",e.safe),p.xp6(1),p.Q6J("ngIf",!e.safe),p.xp6(4),p.Q6J("ngForOf",e.enemies)}}const y=[{path:"",component:(()=>{class e{constructor(e){this.gameData=e}ngOnInit(){this.data=this.gameData,this.battleTargetFloor=0,this.battleTargetGroup={},this.battleTarget=null,this.battleRewards={Resources:[],Experience:0},this.inBattle=!1,this.transitionBattle=!1,setInterval(()=>{this.checkForEnemies()},5e3)}startBattle(e,t){let r=document.getElementById("battleContainer");this.battleTargetFloor=t,this.battleTargetGroup=e,this.transitionBattle=!0,r.classList.remove("hidden"),r.style.animationName="growFromCenter"}doBattleTurn(){this.attackEnemy();for(var e=0;e<this.battleTargetGroup.enemies.length;e++)if(this.attackPlayer(this.battleTargetGroup.enemies[e]),this.data.player.health<=0)return void this.closeBattle();this.checkForBattleComplete()}attackEnemy(){this.battleTarget?(this.battleTarget.health-=Math.max(this.data.player.power-this.battleTarget.defence,1),this.battleTarget.health<=0&&this.enemyDeath(this.battleTarget)):(this.battleTargetGroup.enemies[0].health-=this.data.player.power-this.battleTargetGroup.enemies[0].defence,this.battleTargetGroup.enemies[0].health<=0&&this.enemyDeath(this.battleTargetGroup.enemies[0]))}enemyDeath(e){var t=this.battleTargetGroup.enemies.indexOf(e);this.data.player.experience+=e.rewards.experience,this.checkPlayerLevelup();for(var r=0;r<e.rewards.resources.length;r++)this.data.player.discoveredResources[e.rewards.resources[r].type]||(this.data.player.discoveredResources[e.rewards.resources[r].type]=!0),this.data.player.resources[e.rewards.resources[r].type]+=e.rewards.resources[r].amount,this.data.player.resources[e.rewards.resources[r].type]>this.data.player.maxResource&&(this.data.player.resources[e.rewards.resources[r].type]=this.data.player.maxResource);this.battleTargetGroup.enemies.splice(t,1)}attackPlayer(e){this.data.player.health-=Math.max(e.power-this.data.player.defence,1)}checkForBattleComplete(){this.battleTargetGroup.enemies.length<=0&&this.winBattle()}checkPlayerLevelup(){this.data.player.experience>=this.data.player.nextExperience&&(this.data.player.experience=0,this.data.player.maxHealth+=5*this.data.player.level,this.data.player.maxResource+=10*this.data.player.level,this.data.player.power+=2,this.data.player.defence+=1,this.data.player.nextExperience+=50*this.data.player.level,this.data.player.level+=1)}winBattle(){var e=this.data.house.floors[this.battleTargetFloor].groups.indexOf(this.battleTargetGroup);this.data.house.floors[this.battleTargetFloor].groups.splice(e,1),this.closeBattle()}closeBattle(){let e=document.getElementById("battleContainer");this.battleTargetGroup={},this.battleTarget=null,this.transitionBattle=!0,this.data.player.health=this.data.player.maxHealth,e.classList.remove("grown"),e.style.animationName="shrinkToCenter"}randomInt(e){return Math.floor(Math.random()*e)}checkForEnemies(){let e=0;this.data&&this.data.house.floors.forEach(t=>{t.safe||(this.randomInt(100)<100-5*t.enemies.length&&this.spawnEnemy(e),this.moveEnemies(e)),e++})}moveEnemies(e){let t=0;this.data.house.floors[e].enemies.forEach(r=>{if(this.randomInt(100)<25){e.toString();let n=document.getElementById("f"+e.toString()+r.name+t);if(null!=n){let e=this.randomInt(parseInt(getComputedStyle(n.parentElement).width.replace("px",""))-138),r=this.randomInt(parseInt(getComputedStyle(n.parentElement).height.replace("px",""))-138),a=this.randomInt(5)+3,o=this.randomInt(5)+3,i="left "+a.toString()+"s, top "+o.toString()+"s";n.style.transition=i,n.style.left=e.toString()+"px",n.style.top=r.toString()+"px",n.style.zIndex=r.toString(),t++}}})}enemyHealthBarWidth(e,t,r){var n=document.getElementById("f"+r.toString()+(e.name+t).toString()).children[1].children[0],a=e.health/e.maxHealth;n.style.width=(a*=100).toString()+"%"}setEnemyPos(e,t,r){var n=document.getElementById("f"+r.toString()+(e.name+t).toString());if(null!=n&&0==e.init){let t=parseInt(getComputedStyle(n.parentElement).width.replace("px","")),r=parseInt(getComputedStyle(n.parentElement).height.replace("px","")),a=this.randomInt(t-138).toString()+"px";n.style.left=a;let o=this.randomInt(r-138).toString();n.style.top=o+"px",n.style.zIndex=o,e.init=!0}}spawnEnemy(e){let t=c[this.randomInt(c.length)],r=this.generateEnemy(e,t);this.data.house.floors[e].enemies.push(r)}clickEnemy(e,t){e.health-=Math.max(this.data.player.power-e.defence,1),e.health<=0&&this.killEnemy(e,t)}killEnemy(e,t){let r=this.data.house.floors[t].enemies.indexOf(e);this.data.player.experience+=e.rewards.experience,this.checkPlayerLevelup();for(var n=0;n<e.rewards.resources.length;n++)this.data.player.discoveredResources[e.rewards.resources[n].type]||(this.data.player.discoveredResources[e.rewards.resources[n].type]=!0),this.data.player.resources[e.rewards.resources[n].type]+=e.rewards.resources[n].amount,this.data.player.resources[e.rewards.resources[n].type]>this.data.player.maxResource&&(this.data.player.resources[e.rewards.resources[n].type]=this.data.player.maxResource);this.data.house.floors[t].enemies.splice(r,1)}generateEnemyGroup(e){let t=this.randomInt(4)+1,r=c[this.randomInt(c.length)],n={enemies:[]};for(var a=0;a<t;a++){let t=this.generateEnemy(e,r);n.enemies.push(t)}this.data.house.floors[e].groups.push(n)}generateEnemy(e,t){let r=Math.floor(Math.max(0,15-e)/2.6*20),n=(Math.max(e-10,0),this.randomInt(100)),a=1+this.randomInt(e);if(n<r){let e=JSON.parse(JSON.stringify(l));return e.init=!1,e.type=t,e.multiplier=a,e.health*=e.multiplier,e.maxHealth=e.health,e.power*=e.multiplier,e.defence*=e.multiplier,e.rewards.resources[0].amount*=e.multiplier,e.rewards.experience*=e.multiplier,e.rewards.resources.push({type:t,amount:5*e.multiplier}),e}{let e=JSON.parse(JSON.stringify(d));return e.init=!1,e.type=t,e.multiplier=a,e.health*=e.multiplier,e.maxHealth=e.health,e.power*=e.multiplier,e.defence*=e.multiplier,e.rewards.resources[0].amount*=e.multiplier,e.rewards.experience*=e.multiplier,e.rewards.resources.push({type:t,amount:100*e.multiplier}),e}}getNextFloorCost(){return Math.pow(2,this.data.house.height)+10*this.data.house.height}buildNextFloor(){var e=this.getNextFloorCost();if(this.data.player.resources.Build>=e)this.data.house.floors.push({safe:!1,machines:null,enemies:[],groups:[]}),this.data.house.height++,this.data.player.resources.Build-=e;else{var t=document.getElementById("floor-purchase");t.style.animationName="shake",t.style.animationDirection="both",t.style.animationTimingFunction="cubic-bezier(.36,.07,.19,.97)",t.style.backgroundColor="rgb(170, 160, 160)",t.addEventListener("animationend",e=>{t.style.animationName="none",t.style.animation=null,t.style.backgroundColor="#AAA"})}}}return e.\u0275fac=function(t){return new(t||e)(p.Y36(h.M))},e.\u0275cmp=p.Xpm({type:e,selectors:[["app-tab1"]],decls:13,vars:4,consts:[[3,"translucent"],[3,"fullscreen"],[1,"floor-container"],["class","floor",4,"ngFor","ngForOf"],["id","floor-purchase",3,"click"],[2,"color","black","margin-right","12px"],["src","assets/resources/Build.png",2,"width","24px","height","24px"],[2,"color","#09F"],[1,"floor"],[1,"floor-header"],["id","floor_number"],["id","safety-text","style","background-color: green; width: 64px;",4,"ngIf"],["id","safety-text","style","background-color: red; width: 96px;",4,"ngIf"],[1,"floor-content"],[1,"floor-drops-container"],[1,"floor-enemy-container"],["class","floor-enemy",3,"id",4,"ngFor","ngForOf"],["id","safety-text",2,"background-color","green","width","64px"],["id","safety-text",2,"background-color","red","width","96px"],[1,"floor-enemy",3,"id"],[1,"floor-enemy-name"],[1,"fillbar-container"],[1,"fillbar"],["src","assets/enemies/imp.png",1,"enemy-sprite",2,"width","128px","height","102px",3,"click"]],template:function(e,t){1&e&&(p.TgZ(0,"ion-header",0),p.TgZ(1,"ion-toolbar"),p.TgZ(2,"ion-title"),p._uU(3," House "),p.qZA(),p.qZA(),p.qZA(),p.TgZ(4,"ion-content",1),p.TgZ(5,"div",2),p.YNc(6,f,10,4,"div",3),p.TgZ(7,"div",4),p.NdJ("click",function(){return t.buildNextFloor()}),p.TgZ(8,"span",5),p._uU(9,"Build next floor:"),p.qZA(),p._UZ(10,"img",6),p.TgZ(11,"span",7),p._uU(12),p.qZA(),p.qZA(),p.qZA(),p.qZA()),2&e&&(p.Q6J("translucent",!0),p.xp6(4),p.Q6J("fullscreen",!0),p.xp6(2),p.Q6J("ngForOf",t.data.house.floors),p.xp6(6),p.hij(" ",t.getNextFloorCost(),""))},directives:[n.Gu,n.sr,n.wd,n.W2,a.sg,a.O5],styles:[".floor-container[_ngcontent-%COMP%]{width:calc(100% - 16px);height:calc(100% - 16px);border:1px solid green;border-radius:8px;padding:8px;margin:8px;color:green;white-space:pre-wrap;overflow-y:auto;display:flex;flex-direction:column-reverse}.floor[_ngcontent-%COMP%]{background:#e9e9e9;background:radial-gradient(circle,#e9e9e9 0,#c2c2c2 35%,#9c9c9c 100%)}#floor-purchase[_ngcontent-%COMP%], .floor[_ngcontent-%COMP%]{width:100%;min-height:256px;margin-top:8px;border-radius:8px}#floor-purchase[_ngcontent-%COMP%]{line-height:256px;font-size:24px;background-color:#aaa;border:1px solid #fff;text-align:center;animation-duration:.2s}#floor-purchase[_ngcontent-%COMP%]:hover{background-color:#777}.floor-header[_ngcontent-%COMP%]{justify-content:space-between;display:flex;flex-direction:row;width:100%;height:32px;line-height:32px}.fillbar-container[_ngcontent-%COMP%]{border:3px solid #555;background-color:#ddd;border-radius:4px;width:128px;height:16px;padding:1px}.fillbar[_ngcontent-%COMP%]{border-radius:2px;background-color:#1ab3f1;height:100%}.floor-content[_ngcontent-%COMP%]{height:calc(100% - 32px);border-bottom-left-radius:4px;border-bottom-right-radius:4px}.floor-content[_ngcontent-%COMP%], .floor-enemy-groups[_ngcontent-%COMP%]{display:flex;align-items:center;width:100%}.floor-enemy-groups[_ngcontent-%COMP%]{flex-direction:row;justify-content:space-around}.floor-enemy-container[_ngcontent-%COMP%]{list-style:none;width:100%;height:100%;position:relative;padding-right:16px;padding-left:16px}.floor-enemy[_ngcontent-%COMP%]{transition-property:left,top;transition-duration:2s}.floor-drops[_ngcontent-%COMP%], .floor-enemy[_ngcontent-%COMP%]{position:absolute;align-items:center}.floor-enemy-name[_ngcontent-%COMP%]{padding:2px;border-radius:2px;color:#1ab3f1;background-color:#fff}.enemy-group-container[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:space-around}.enemy-group-infobox[_ngcontent-%COMP%]{visibility:hidden;width:auto;background-color:#000;color:#fff;text-align:center;padding:5px;border-radius:6px;position:absolute;bottom:128px;z-index:1}.enemy-group-container[_ngcontent-%COMP%]:hover   .enemy-group-infobox[_ngcontent-%COMP%]{visibility:visible}.enemy-group-container[_ngcontent-%COMP%]:hover{background-color:#6af}.hidden[_ngcontent-%COMP%]{visibility:hidden}.battle-container[_ngcontent-%COMP%]{position:absolute;flex-direction:column;align-items:center;left:50%;right:50%;top:50%;bottom:50%;border:1px solid #000;background-color:#fff;border-radius:8px;animation-duration:.75s;animation-fill-mode:forwards}.battle-container[_ngcontent-%COMP%], .battle-enemy-field[_ngcontent-%COMP%]{display:flex;justify-content:space-around}.battle-enemy-field[_ngcontent-%COMP%]{position:relative;height:300px;width:100%;flex-direction:row;flex-wrap:wrap;align-items:flex-end}.battle-enemy-infobox[_ngcontent-%COMP%]{visibility:hidden;width:128px;background-color:#000;color:#fff;text-align:center;padding:5px;border-radius:6px;display:flex;flex-direction:column;align-items:center;position:absolute;top:0;z-index:1}.battle-enemy[_ngcontent-%COMP%]:hover   .battle-enemy-infobox[_ngcontent-%COMP%]{visibility:visible}.battle-player-actions[_ngcontent-%COMP%]{height:192px;width:100%;border-radius:4px;border:1px solid #000;display:flex;flex-direction:row;align-items:center;justify-content:space-around}.battle-player-actions[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]{background:#0000;color:#000;font-size:24px}.battle-player-actions[_ngcontent-%COMP%]   .action[_ngcontent-%COMP%]:hover{text-decoration:underline}.battle-player-info[_ngcontent-%COMP%]{height:128px;width:128px;border:1px solid #000;border-radius:4px;font-size:16px;color:#000;display:flex;flex-direction:column;align-items:center}.player-info-name[_ngcontent-%COMP%]{display:flex;border-bottom:1px solid #000;height:32px;width:100%;align-items:center;justify-content:space-around}.player-info-stat[_ngcontent-%COMP%]{margin:4px;display:flex;align-items:center;justify-content:space-between;width:calc(100% - 8px)}#floor_number[_ngcontent-%COMP%]{color:#08f;background-color:#fff;width:64px}#floor_number[_ngcontent-%COMP%], #safety-text[_ngcontent-%COMP%]{border-radius:8px;text-align:center}#safety-text[_ngcontent-%COMP%]{color:#fff}#moves[_ngcontent-%COMP%]{width:calc(100% - 16px);height:15%;border:1px solid green;border-radius:8px;padding:8px;white-space:pre-wrap;overflow-y:auto}#commandBox[_ngcontent-%COMP%], #moves[_ngcontent-%COMP%]{margin:8px;color:green}#commandBox[_ngcontent-%COMP%]{display:flex;align-items:center}#commandBox[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%]{--placeholder-color:#a9a9a9}@keyframes shake{10%,90%{transform:translate3d(-1px,0,0)}20%,80%{transform:translate3d(2px,0,0)}30%,50%,70%{transform:translate3d(-4px,0,0)}40%,60%{transform:translate3d(4px,0,0)}}@keyframes attack{25%{transform:translate3d(0,4px,0)}to{transform:translate3d(0,-4px,0)}}@keyframes growFromCenter{0%{left:50%;top:50%;width:0;height:0}to{left:12%;top:25%;width:75%;height:50%}}@keyframes shrinkToCenter{0%{left:12%;top:25%;width:75%;height:50%}to{left:50%;top:50%;width:0;height:0}}.grown[_ngcontent-%COMP%]{left:12%;top:25%;width:75%;height:50%}"]}),e})()}];let x=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=p.oAB({type:e}),e.\u0275inj=p.cJS({imports:[[s.Bz.forChild(y)],s.Bz]}),e})(),b=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=p.oAB({type:e}),e.\u0275inj=p.cJS({imports:[[n.Pc,a.ez,o.u5,i.e,x]]}),e})()}}]);